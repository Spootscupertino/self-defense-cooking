<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Self-Defense Cooking Recipes</title>
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        #recipesList { margin-top: 20px; }
        .warn { padding: 12px 14px; border: 2px solid #b42318; background: #fff5f5; border-radius: 10px; max-width: 900px; }
        .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
    </style>
</head>
<body>
    <div class="warn">
        <div><strong>Warning:</strong> You are rendering <span class="mono">self-defense-cooking/public/index.html</span> (legacy/stale entrypoint).</div>
        <div>Fix: open <span class="mono">self-defense-cooking/index.html</span> or serve the repo root.</div>
    </div>
    <h1>Recipes</h1>
    <ul id="recipesList">
    </ul>
    <script>
        window.__RECIPE_ENGINE_BUILD__ = {
          entrypoint: "self-defense-cooking/public/index.html",
          sourceFile: "/Users/ericeldridge/Desktop/recipe-engine/self-defense-cooking/public/index.html",
          repo: { name: "self-defense-cooking", commit: "5f72a2b" },
          timestamp: new Date().toISOString()
        };
        console.log('[recipe-engine build-stamp]', window.__RECIPE_ENGINE_BUILD__);

        // Fetch list of recipes from the /recipes directory
        async function loadRecipes() {
            try {
                const response = await fetch('/recipes/list.json');
                const recipes = await response.json();
                const list = document.getElementById('recipesList');
                recipes.forEach(recipe => {
                    const li = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = '/recipes/' + recipe.slug + '/recipe.json';
                    link.textContent = recipe.title;
                    li.appendChild(link);
                    list.appendChild(li);
                });
            } catch (err) {
                document.getElementById('recipesList').textContent = 'No recipes found.';
            }
        }
        loadRecipes();
    </script>
        <footer id="buildStamp" class="mono" style="margin-top:16px; opacity:0.85; font-size:12px;"></footer>
        <script>
            (function () {
                const b = window.__RECIPE_ENGINE_BUILD__;
                const el = document.getElementById('buildStamp');
                if (el) el.textContent = `ENTRY=${b.entrypoint} | FILE=${b.sourceFile} | nested@${b.repo.commit} | time=${b.timestamp} | location=${location.href}`;
            })();
        </script>
</body>
</html>
